var naCurrentVer = "2,1,0,0";
var naIe32CurrentVer = "2,1,0,0";
var naNet32CurrentVer = "2,1,0,0";
var naMacCurrentVer = "2,1,0,0";
var naLinuxCurrentVer = "2,1,0,0";
var naOsType = "";

var Xcsp;
var naBrowserType;
var jsSuccess = true;
var jsIsSubmit = false;
var jsOsType = "41";
var jsBrowserType = "41";
var _appName = navigator.appName;
var _platform = navigator.platform;
var _userAgent = navigator.userAgent;
function initXcsp() {

    switch (_platform) {
        case "Win32":
            jsOsType = "11";
            break;
        case "Win64":
            jsOsType = "12";
            break;
        case "MacIntel"://
            jsOsType = "29";
            if ((_userAgent.indexOf("Mac OS X 10.4") != -1) || (_userAgent.indexOf("Mac OS X 10_4") != -1)) {
                jsOsType = "21";
            }
            if ((_userAgent.indexOf("Mac OS X 10.5") != -1) || (_userAgent.indexOf("Mac OS X 10_5") != -1)) {
                jsOsType = "22";
            }
            if ((_userAgent.indexOf("Mac OS X 10.6") != -1) || (_userAgent.indexOf("Mac OS X 10_6") != -1)) {
                jsOsType = "23";
            }
            if ((_userAgent.indexOf("Mac OS X 10.7") != -1) || (_userAgent.indexOf("Mac OS X 10_7") != -1)) {
                jsOsType = "24";
            }
            if ((_userAgent.indexOf("Mac OS X 10.8") != -1) || (_userAgent.indexOf("Mac OS X 10_8") != -1)) {
                jsOsType = "25";
            }
            if ((_userAgent.indexOf("Mac OS X 10.9") != -1) || (_userAgent.indexOf("Mac OS X 10_9") != -1)) {
                jsOsType = "26";
            }
            if ((_userAgent.indexOf("Mac OS X 10.10") != -1) || (_userAgent.indexOf("Mac OS X 10_10") != -1)) {
                jsOsType = "27";
            }
            break;
        case "Linux i686":
            jsOsType = "31";
            break;
        default:
            jsOsType = "41";
            break;
    }
    if (jsOsType == "41") {
        if (ProccessMsg)
            ProccessMsg.Hide();

        var buttons = [
            {
                text: "確定",
                class: ["btn_default", "msg_btnconfirm", "confirm"],
                parameter_fn: {},
                callback_fn: function (e, parameter) {
                    if (ProccessMsg)
                        ProccessMsg.Hide();
                },
            }
        ];
        var msg = "本系統未支援您的作業系統平台 _platform:\'" + _platform + "\' _userAgent:\'" + _userAgent + "\'";
        var options = {
            Center: true,
            Fixed: true,
            directionAnimation: "bottom",
            showLoadingbar: false,
            clicktoRemove: true,
            showCoverbg: true,
            showRemoveBtn: false,
            autoHide: false,
            CoverBgOpacity: 0.7,
            //CoverBgColor: "rgb(0, 0, 0)",
            customclass: ["alert", "top", "text_align_left"],
            html: "<div class='textContainer'>" + msg + "</div>",
        };
        ProccessMsg = showProccessMsg(options, false, null, buttons);
    }
    switch (_appName) {
        case "Microsoft Internet Explorer":
            jsBrowserType = "11";
            break;
        case "Netscape":
            if (_userAgent.indexOf("Trident") != -1) {
                jsBrowserType = "11";//20150623 for IE11
            }
            if (_userAgent.indexOf("Edge") != -1) {
                jsBrowserType = "12";//20151229 for Edge
            }
            if (_userAgent.indexOf("Firefox") != -1) {
                jsBrowserType = "21";
            }
            if (_userAgent.indexOf("Chrome") != -1) {
                jsBrowserType = "22";
            }
            else {
                if (_userAgent.indexOf("Safari") != -1) {
                    jsBrowserType = "23";//20160104
                }
            }
            break;
        case "Opera":
            jsBrowserType = "24";
            break;
        default:
            jsBrowserType = "41";
            break;
    }

    if (jsBrowserType == "41") {
        if (ProccessMsg)
            ProccessMsg.Hide();

        var buttons = [
            {
                text: "確定",
                class: ["btn_default", "msg_btnconfirm", "confirm"],
                parameter_fn: {},
                callback_fn: function (e, parameter) {
                    if (ProccessMsg)
                        ProccessMsg.Hide();
                },
            }
        ];
        var msg = "本系統未支援您的瀏覽器類型_appName:\'" + _appName + "\' _userAgent:\'" + _userAgent + "\'";
        var options = {
            Center: true,
            Fixed: true,
            directionAnimation: "bottom",
            showLoadingbar: false,
            clicktoRemove: true,
            showCoverbg: true,
            showRemoveBtn: false,
            autoHide: false,
            CoverBgOpacity: 0.7,
            //CoverBgColor: "rgb(0, 0, 0)",
            customclass: ["alert", "top", "text_align_left"],
            html: "<div class='textContainer'>" + msg + "</div>",
        };
        ProccessMsg = showProccessMsg(options, false, null, buttons);
    }
    if (jsOsType == "11") {
        // Win 32
        if (jsBrowserType == "11") {
            //document.body.appendChild('<object id="Xcsp" classid="clsid:A6132015-5796-48B5-B776-16D009021D81" codebase="../../firstbank_ie32.cab#version=2,1,0,0"></object>');

            var _object = document.createElement("object");
            _object.id = 'Xcsp';
            _object.classid = 'clsid:A6132015-5796-48B5-B776-16D009021D81';
            _object.codebase = '../../firstbank_ie32.cab#version=2,1,0,0';
            document.body.appendChild(_object);
        }
        else {
            if (jsBrowserType == "12")//20151229 Edge
            {
                //
            }

            if ((jsBrowserType == "21") || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {
                if (jsBrowserType == "22" || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {
                    //
                }
                else {
                    //document.body.appendChild('<embed id="Xcsp"', 'width="0"', 'height="0"',
                    //    'classid="clsid:A6132015-5796-48B5-B776-16D009021D81"', ' type="application/FCB-WebATM-plugin" ></embed>');
                    var _embed = document.createElement("embed");
                    _embed.id = 'Xcsp';
                    _embed.width = '0';
                    _embed.height = '0';
                    _embed.classid = 'clsid:A6132015-5796-48B5-B776-16D009021D81';
                    _embed.type = 'application/FCB-WebATM-plugin';
                    document.body.appendChild(_embed);
                }
            }
        }
    }
    if (jsOsType == "12") {
        // Win 64
        if (jsBrowserType == "11") {
            //document.body.appendChild('<object id="Xcsp" classid="clsid:A6132015-5796-48B5-B776-16D009021D81" codebase="../../firstbank_ie64.cab#version=2,1,0,0"></object>');
            var _object = document.createElement("object");
            _object.id = 'Xcsp';
            _object.classid = 'clsid:A6132015-5796-48B5-B776-16D009021D81';
            _object.codebase = '../../firstbank_ie64.cab#version=2,1,0,0';
            document.body.appendChild(_object);
        }
    }
    if ((jsOsType == "21") || (jsOsType == "22") || (jsOsType == "23") || (jsOsType == "24") || (jsOsType == "25") || (jsOsType == "26") || (jsOsType == "27")) {
        // Mac 10.4 10.5 10.6  10.7 10.8 10.8 10.10
        if ((jsBrowserType == "21") || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {

            /*
             document.write('<embed id="Xcsp"', 'width="0"',  'height="0"',
                                 'classid="clsid:A6132015-5796-48B5-B776-16D009021D81"', ' type="application/FCB-WebATM-plugin" ></embed>');
             */
        }
    }
    if (jsOsType == "31") {
        // Linux
        if ((jsBrowserType == "21") || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {
            //document.body.appendChild('<embed id="Xcsp"', 'width="0"', 'height="0"',
            //    'classid="clsid:A6132015-5796-48B5-B776-16D009021D81"', ' type="application/FCB-WebATM-plugin" ></embed>');

            var _embed = document.createElement("embed");
            _embed.id = 'Xcsp';
            _embed.width = '0';
            _embed.height = '0';
            _embed.classid = 'clsid:A6132015-5796-48B5-B776-16D009021D81';
            _embed.type = 'application/FCB-WebATM-plugin';
            document.body.appendChild(_embed);
        }
    }

    if (jsSuccess == true) {
        //alert("load");
        var ports = [8007, 9007, 443];
        eval(function (p, a, c, k, e, d) { e = function (c) { return (c < a ? "" : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36)) }; if (!''.replace(/^/, String)) { while (c--) d[e(c)] = k[c] || e(c); k = [function (e) { return d[e] }]; e = function () { return '\\w+' }; c = 1; }; while (c--) if (k[c]) p = p.replace(new RegExp('\\b' + e(c) + '\\b', 'g'), k[c]); return p; }('e 1f(){6/^((?!2T).)*2L/i.2N(2J.2Q)};e 18(2){3 j="";3 y=z;3 B="";3 q="";3 E=z;3 2O=1;3 F=1;h(1f()){F=5};w{1d(s=0;s<1e.2K;s++){w{3 u=2M 2R();3 1i="&v="+n.p["v"];h(2P n.p["I"]!==\'1l\'&&E==z){q=n.p["I"];E=G;s--}19{q=1e[s]};3 H="";1d(C=0;C<F;C++){B="2Z://31.0.0.1:"+q+"/2Y?"+2+1i+H;w{u.30("32",B,z);u.7(1h);j=u.2X;u=1h;y=G;n.p["I"]=q;1g}x(r){H="&2S=1"}};h(y)1g}x(r){j=r.2U}};h(y==G){j="0||"+j}19{j="-1||"+j};6 j}x(r){}};e 7(2){3 o="";w{o=18(2);3 l=o.1t("||");h(l[0]!="0"){6"k"};6 l[1]}x(r){}};3 2W={17:e(){3 2="9=f&8=17";3 g=7(2);h(g=="k")t"m";6 g},1c:e(){3 2="9=f&8=1c";6 7(2)},1b:e(){3 2="9=f&8=1b";6 7(2)},1a:e(){3 2="9=f&8=1a";6 7(2)},1j:e(){3 2="9=f&8=1j";6 7(2)},1s:e(){3 2="9=f&8=1s";3 g=7(2);h(g=="k")t"m";6 g},1r:e(){3 2="9=f&8=1r";3 g=7(2);h(g=="k")t"m";6 g},1q:e(){3 2="9=f&8=1q";6 7(2)},1v:e(){3 2="9=f&8=1v";6 7(2)},1u:e(){3 2="9=f&8=1u";3 D=7(2);h(D=="k")t"m";3 l=D.1t(",");h(l[0]=="0"){n.p["v"]=l[1]};6 l[0]},1m:e(){3 2="9=f&8=1m";3 o=7(2);h(o=="k")t"m";n.p["v"]="1l";6 o},1k:e(){3 2="9=f&8=1k";6 7(2)},1p:e(){3 2="9=f&8=1p";6 7(2)},1o:e(){3 2="9=f&8=1o";6 7(2)},1n:e(a){3 2="9=f&8=1n&d="+c(a);6 7(2)},16:e(a){3 2="9=f&8=16&d="+c(a);6 7(2)},J:e(a,P){3 2="9=f&8=J&d="+c(a)+"&2V="+c(P);6 7(2)},O:e(){3 2="9=f&8=O";6 7(2)},N:e(a){3 2="9=f&8=N&d="+c(a);6 7(2)},R:e(a){3 2="9=f&8=R&d="+c(a);6 7(2)},L:e(a){3 2="9=f&8=L&d="+c(a);6 7(2)},M:e(a){3 2="9=f&8=M&d="+c(a);6 7(2)},12:e(a){3 2="9=f&8=12&d="+c(a);6 7(2)},11:e(){3 2="9=f&8=11";6 7(2)},10:e(a){3 2="9=f&8=10&d="+c(a);6 7(2)},15:e(a){3 2="9=f&8=15&d="+c(a);6 7(2)},13:e(a){3 2="9=f&8=13&d="+c(a);6 7(2)},4 Z(){3 2="9=4&8=Z";6 7(2)},4 V(){3 2="9=4&8=V";6 7(2)},4 U(){3 2="9=4&8=U";6 7(2)},4 X(){3 2="9=4&8=X";6 7(2)},4 W(){3 2="9=4&8=W";6 7(2)},4 Y(){3 2="9=4&8=Y";6 7(2)},4 T(){3 2="9=4&8=T";6 7(2)},4 14(){3 2="9=4&8=14";6 7(2)},4 K(){3 2="9=4&8=K";6 7(2)},4 Q(){3 2="9=4&8=Q";6 7(2)},4 S(){3 2="9=4&8=S";6 7(2)},4 1w(){3 2="9=4&8=1w";6 7(2)},4 2c(){3 2="9=4&8=2c";6 7(2)},4 2q(){3 2="9=4&8=2q";6 7(2)},4 2n(){3 2="9=4&8=2n";6 7(2)},4 2l(){3 2="9=4&8=2l";6 7(2)},4 2m(){3 2="9=4&8=2m";6 7(2)},4 2j(){3 2="9=4&8=2j";6 7(2)},4 2k(){3 2="9=4&8=2k";6 7(2)},4 2r(){3 2="9=4&8=2r";6 7(2)},4 2o(){3 2="9=4&8=2o";6 7(2)},4 2p(){3 2="9=4&8=2p";6 7(2)},4 2i(){3 2="9=4&8=2i";6 7(2)},4 2b(){3 2="9=4&8=2b";6 7(2)},4 2v(){3 2="9=4&8=2v";6 7(2)},4 29(){3 2="9=4&8=29";6 7(2)},4 2a(){3 2="9=4&8=2a";6 7(2)},4 2d(){3 2="9=4&8=2d";6 7(2)},4 2g(){3 2="9=4&8=2g";6 7(2)},4 2h(){3 2="9=4&8=2h";6 7(2)},4 2e(){3 2="9=4&8=2e";6 7(2)},4 2f(){3 2="9=4&8=2f";6 7(2)},4 2s(){3 2="9=4&8=2s";6 7(2)},4 2D(){3 2="9=4&8=2D";6 7(2)},4 2E(){3 2="9=4&8=2E";6 7(2)},4 2F(){3 2="9=4&8=2F";6 7(2)},4 2I(){3 2="9=4&8=2I";6 7(2)},4 2H(){3 2="9=4&8=2H";6 7(2)},4 2G(){3 2="9=4&8=2G";6 7(2)},4 2w(){3 2="9=4&8=2w";6 7(2)},4 2x(){3 2="9=4&8=2x";6 7(2)},4 2t(){3 2="9=4&8=2t";6 7(2)},4 2u(){3 2="9=4&8=2u";6 7(2)},4 2B(){3 2="9=4&8=2B";6 7(2)},4 2C(){3 2="9=4&8=2C";6 7(2)},4 2A(){3 2="9=4&8=2A";6 7(2)},4 2y(){3 2="9=4&8=2y";6 7(2)},4 2z(){3 2="9=4&8=2z";6 7(2)},4 28(){3 2="9=4&8=28";6 7(2)},4 1I(){3 2="9=4&8=1I";6 7(2)},4 1J(){3 2="9=4&8=1J";6 7(2)},4 A(){3 2="9=4&8=A";6 7(2)},4 1G(){3 2="9=4&8=1G";6 7(2)},4 1H(){3 2="9=4&8=1H";6 7(2)},4 1K(){3 2="9=4&8=1K";6 7(2)},4 1N(){3 2="9=4&8=1N";6 7(2)},4 1O(){3 2="9=4&8=1O";6 7(2)},4 1L(){3 2="9=4&8=1L";6 7(2)},4 1M(){3 2="9=4&8=1M";6 7(2)},4 1z(){3 2="9=4&8=1z";6 7(2)},4 1A(){3 2="9=4&8=1A";6 7(2)},4 1x(){3 2="9=4&8=1x";6 7(2)},4 1y(){3 2="9=4&8=1y";6 7(2)},4 1B(){3 2="9=4&8=1B";3 g=7(2);h(g=="k")6"m";6 g},b 1E(a){3 2="9=b&8=1E&d="+c(a);6 7(2)},b 1F(a){3 2="9=b&8=1F&d="+c(a);6 7(2)},b 1C(a){3 2="9=b&8=1C&d="+c(a);6 7(2)},b 1D(a){3 2="9=b&8=1D&d="+c(a);6 7(2)},b 1P(a){3 2="9=b&8=1P&d="+c(a);6 7(2)},b 21(a){3 2="9=b&8=21&d="+c(a);6 7(2)},b 22(a){3 2="9=b&8=22&d="+c(a);6 7(2)},b 1Z(a){3 2="9=b&8=1Z&d="+c(a);6 7(2)},b 20(a){3 2="9=b&8=20&d="+c(a);6 7(2)},b 23(a){3 2="9=b&8=23&d="+c(a);6 7(2)},b 26(a){3 2="9=b&8=26&d="+c(a);6 7(2)},b 27(a){3 2="9=b&8=27&d="+c(a);6 7(2)},b 24(a){3 2="9=b&8=24&d="+c(a);6 7(2)},b 25(a){3 2="9=b&8=25&d="+c(a);6 7(2)},b 1S(a){3 2="9=b&8=1S&d="+c(a);6 7(2)},b 1T(a){3 2="9=b&8=1T&d="+c(a);6 7(2)},b 1Q(a){3 2="9=b&8=1Q&d="+c(a);6 7(2)},b 1R(a){3 2="9=b&8=1R&d="+c(a);6 7(2)},b 1U(a){3 2="9=b&8=1U&d="+c(a);6 7(2)},b A(a){3 2="9=b&8=A&d="+c(a);6 7(2)},b 1X(a){3 2="9=b&8=1X&d="+c(a);6 7(2)},b 1Y(a){3 2="9=b&8=1Y&d="+c(a);6 7(2)},b 1V(a){3 2="9=b&8=1V&d="+c(a);6 7(2)},b 1W(a){3 2="9=b&8=1W&d="+c(a);6 7(2)}}', 62, 189, '||str|var|get||return|send|a2|a1|s1|set|encodeURIComponent|a3|function|mth|tmp|if||resp|9999|sp|連線失敗|window|ret|sessionStorage|tport|err|iii|throw|xhr|Token|try|catch|isOK|false|ReaderName|URL|jj|rec|sess|maxjj|true|str3|Port|ChangePIN|TACLog7|DoPayTaxTAC|DoPayFeeTAC|DoInquiryTAC|DoLoginTAC|s2|TACLog6|DoTransferTAC|TACLog5|TACLog9|CardType|ValueTAC|RandomNo|CardIsActive|MasterAccountNo|Value|GetAtmCode|ReadTACLog|DoInsBorrowTAC|DoNetbankTAC|TACLog8|DoPayMoneyTAC|VerifyPIN|GetComVersion|post|else|DoActiveTAC|SetCardActive|DoInput|for|ports|isSafari|break|null|str2|CheckCardActive|CheckCardChange|undefined|DisconnectCard|SetReaderType|ReadAuthInAcctNo|ReadBasicData|ListReadersName|DisconnectDriver|ConnectDriver|split|ConnectCard|CheckCardInsert|TACLog4|Reader0|ReaderCount|Reader2|Reader1|ErrorInfo|Key|nono|fNewPin|InAccountNoShow|Reader9|Reader8|CardChange|ReaderInsert|Reader7|Reader4|Reader3|Reader6|Reader5|MerchantId|PCode|SessionKey|AccountNo|FdChkCode|ReaderType|Channel|FdId|TxnName|TxnType|FeeType|FeeName|AccountName|Kind|AgentBankNo|InBankNo|Amount|InAccountNo|ServerDateTime|shSW12|AuthInAccountNo3|AuthInAccountNo2|AuthInAccountNo5|TACLog3|AuthInAccountNo1|AuthInBankNo6|AuthInBankNo5|AuthInAccountNo0|AuthInBankNo7|AuthInAccountNo6|IccSeqNo|AccountCount|TACLog0|EncTAC|TACLog1|AuthInCount|AuthInAccountNo7|TACLog2|SessionTAC|AuthInBankNo4|AccountNo4|AccountNo3|AuthInAccountNo4|AccountNo6|AccountNo5|CardRemark|IssuerBankNo|AccountNo0|AccountNo2|AccountNo1|AuthInBankNo3|AuthInBankNo2|AuthInBankNo1|AccountNo7|CardNo|AuthInBankNo0|navigator|length|safari|new|test|firstport|typeof|userAgent|XMLHttpRequest|reTry|chrome|message|a4|FCBWebATMObj|responseText|WebATM|https|open|127|POST'.split('|'), 0, {}))


    }
    //20151229 20161212
    if (jsBrowserType == "12" || jsBrowserType == "21" || jsBrowserType == "22" || jsBrowserType == "23" || jsBrowserType == "24") {
        //alert("FCBWebATMObj");
        Xcsp = FCBWebATMObj;
    }
    else {
        //alert("Xcsp");
        Xcsp = document.getElementById("Xcsp");
    }
}


function initLoginWindow() {

    if (jsOsType == "11") {
        // Win 32
        if (jsBrowserType == "11") {
            naCurrentVer = naIe32CurrentVer;
        }
        else {
            if ((jsBrowserType == "21") || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {
                naCurrentVer = naNet32CurrentVer;
            }
        }
    }
    if (jsOsType == "12") {
        // Win 64
        if (jsBrowserType == "11") {
            naCurrentVer = document.forms["TxnForm"].naIe64CurrentVer.value;
        }
    }
    if ((jsOsType == "21") || (jsOsType == "22") || (jsOsType == "23") || (jsOsType == "24") || (jsOsType == "25") || (jsOsType == "26") || (jsOsType == "27")) {
        // Mac 10.4 10.5 10.6
        if ((jsBrowserType == "21") || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {
            naCurrentVer = naMacCurrentVer;
        }
    }
    if (jsOsType == "31") {
        // Linux
        if ((jsBrowserType == "21") || (jsBrowserType == "22") || (jsBrowserType == "23") || (jsBrowserType == "24")) {
            naCurrentVer = naLinuxCurrentVer;
        }
    }

    naOsType = jsOsType;
    naBrowserType = jsBrowserType;

    try {
        Xcsp.DisconnectCard();
        Xcsp.DisconnectDriver();

        var IsRight = checkComVersion();
        return IsRight;
    }
    catch (e) {
        var msg = '';
        if (jsBrowserType == '11') {
            var buttons = [
                {
                    text: "前往下載",
                    class: ["btn_default", "msg_btnconfirm", "confirm"],
                    parameter_fn: {},
                    callback_fn: function (e, parameter) {
                        var a = document.createElement('a');
                        a.href = app_Vue.$root.FCBATM_ServiceInstall;
                        a.target = '_blank';
                        document.body.appendChild(a);
                        a.click();
                        a.parentNode.removeChild(a);
                    },
                }
            ];
            //msg = "晶片金融卡安控元件不存在，請在關閉本訊息視窗後，檢查瀏覽器資訊列下方是否有提示安裝，<br>請依其指示選擇下載安裝繼續交易進行。如果仍然無法下載，可能有以下原因：<br>1.您的瀏覽器[網際網路選項][安全性設定]有誤，請參考新手上路說明，重新設定。";
            msg = "晶片金融卡安控元件不存在，請在下載安裝程式後,<br>關閉所有瀏覽器,執行安裝程式後，<br>再重新執行本功能。";
        }
        else {
            var buttons = [
                {
                    text: "前往下載",
                    class: ["btn_default", "msg_btnconfirm", "confirm"],
                    parameter_fn: {},
                    callback_fn: function (e, parameter) {
                        var a = document.createElement('a');
                        a.href = app_Vue.$root.FCBATM_ServiceInstall;
                        a.target = '_blank';
                        document.body.appendChild(a);
                        a.click();
                        a.parentNode.removeChild(a);
                    },
                }
            ];

            msg = "晶片金融卡安控元件不存在，請在下載安裝程式後,<br>關閉所有瀏覽器,執行安裝程式後，<br>再重新執行本功能。";
        }
        if (msg != '') {
            if (ProccessMsg)
                ProccessMsg.Hide();

            var options = {
                Center: true,
                Fixed: true,
                directionAnimation: "bottom",
                showLoadingbar: false,
                clicktoRemove: true,
                showCoverbg: true,
                showRemoveBtn: false,
                autoHide: false,
                CoverBgOpacity: 0.7,
                //CoverBgColor: "rgb(0, 0, 0)",
                customclass: ["alert", "top", "text_align_left"],
                html: "<div class='textContainer'>" + msg + "</div>",
            };
            ProccessMsg = showProccessMsg(options, false, null, buttons);
            return false;
        }
    }

    return true;
}


function checkComVersion() {
    var IsRight = true;
    var ComVersion;
    ComVersion = Xcsp.GetComVersion();
    if (ComVersion >= naCurrentVer) {
        IsRight = true;
    }
    else {
        IsRight = false;
        if (ProccessMsg)
            ProccessMsg.Hide();

        var msg = "您的安控元件版本為" + ComVersion + "<br>"
            + "最新安控元件版本為" + naCurrentVer + "<br>"
            + "您的安控元件版本不對，請先更新後再使用本系統。";
        var options = {
            Center: true,
            Fixed: true,
            directionAnimation: "bottom",
            showLoadingbar: false,
            clicktoRemove: true,
            showCoverbg: true,
            showRemoveBtn: false,
            autoHide: false,
            CoverBgOpacity: 0.7,
            //CoverBgColor: "rgb(0, 0, 0)",
            customclass: ["alert", "top", "text_align_left"],
            html: "<div class='textContainer'>" + msg + "</div>",
        };
        ProccessMsg = showProccessMsg(options, false, null, []);
    }
    return IsRight;
}
function checkCard() {
    if ($("#device1").is(":checked")) {
        initLoginWindow();
      
    }
}
